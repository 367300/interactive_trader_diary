# –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ –¥–ª—è –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π Python-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ –∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —É–º–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ `.gitignore`.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü–∞—Ä—Å–∏–Ω–≥ Python —Ñ–∞–π–ª–æ–≤** ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π —Å –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏** ‚Äî —Ä–∞–∑–±–∏–≤–∫–∞ `.md`, `.yml`, `.conf` —Ñ–∞–π–ª–æ–≤ –Ω–∞ –±–ª–æ–∫–∏
- **–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–∏—Ç–æ–≤** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ 3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–æ–º–º–∏—Ç–æ–≤ –∫ –∫–∞–∂–¥–æ–º—É –±–ª–æ–∫—É
- **–£–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** ‚Äî –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ .gitignore** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
pip install -r requirements-emb.txt
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- `tiktoken` ‚Äî –ø–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤
- `openai` ‚Äî API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–∏–Ω–≥–æ–≤
- `python-decouple` ‚Äî —á—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `gitpython` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º
- `tqdm` ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
- `rich` ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
OPENAI_API_KEY=your_openai_api_key_here
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å–∫—Ä–∏–ø—Ç–µ:
```python
# –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤
ROOT_DIR = Path('.')

# –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
FILE_EXTENSIONS = ['.py', '.md', '.yml', '.conf']

# –ò–º—è —Ñ–∞–π–ª–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
DB_PATH = 'embeddings.sqlite3'

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–æ–º–º–∏—Ç–æ–≤
N_COMMITS = 3

# –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –±–ª–æ–∫
TOKEN_LIMIT = 1600
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
python generate_embeddings.py
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `embeddings`:
- `id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `embedding` ‚Äî –≤–µ–∫—Ç–æ—Ä —ç–º–±–µ–¥–∏–Ω–≥–∞ (JSON)
- `file_path` ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
- `block_type` ‚Äî —Ç–∏–ø –±–ª–æ–∫–∞ (`method`, `function`, `md`, `yml`, `conf`)
- `class_name` ‚Äî –∏–º—è –∫–ª–∞—Å—Å–∞ (–¥–ª—è –º–µ—Ç–æ–¥–æ–≤)
- `method_name` ‚Äî –∏–º—è –º–µ—Ç–æ–¥–∞/—Ñ—É–Ω–∫—Ü–∏–∏
- `start_line`, `end_line` ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫
- `commit_messages` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–æ–≤ (JSON)
- `raw_text` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –±–ª–æ–∫–∞
- `embedding_text` ‚Äî –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≤ OpenAI API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–º–±–µ–¥–∏–Ω–≥–∞

### –¢–∞–±–ª–∏—Ü–∞ `file_hashes`:
- `file_path` ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É (PRIMARY KEY)
- `file_hash` ‚Äî MD5-—Ö–µ—à —Ñ–∞–π–ª–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üîç –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü–∞—Ä—Å–∏–Ω–≥ Python —Ñ–∞–π–ª–æ–≤
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–æ–≤ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º –æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω–µ –∫–ª–∞—Å—Å–æ–≤
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–∏–º—è –∫–ª–∞—Å—Å–∞, –º–µ—Ç–æ–¥, —Å—Ç—Ä–æ–∫–∏)

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- –†–∞–∑–±–∏–≤–∞–µ—Ç `.md`, `.yml`, `.conf` –Ω–∞ –±–ª–æ–∫–∏ –ø–æ —Ç–æ–∫–µ–Ω–∞–º
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ–ª—É—á–∞–µ—Ç 3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–æ–º–º–∏—Ç–∞
- –î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–æ–≤ –∫ –∫–∞–∂–¥–æ–º—É –±–ª–æ–∫—É

### 4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —ç–º–±–µ–¥–∏–Ω–≥–∞
–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–π –≤ OpenAI API, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `embedding_text`:

```
File: django_base/views.py
Class: UserView
Method/Function: get_user
Lines: 15-30
Recent commits: Add user validation; Fix authentication bug; Update docs

Code:
def get_user(self):
    # class: UserView
    return self.user
```

–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–º–±–µ–¥–∏–Ω–≥–∞.

### 5. –£–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –í—ã—á–∏—Å–ª—è–µ—Ç MD5-—Ö–µ—à –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ —Ö–µ—à–∞–º–∏
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –±–ª–æ–∫–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö

## üö´ –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–∏—Ç–∞–µ—Ç `.gitignore` –∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç:
- –§–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º `.gitignore`
- –ü–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö –ø–∞–ø–æ–∫
- –§–∞–π–ª—ã —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏

### –ü—Ä–∏–º–µ—Ä—ã –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:
- `static/` ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `django_base/static/admin/...`
- `.venv/` ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `.venv/lib/python3.12/...`
- `*.pyc` ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≤—Å–µ `.pyc` —Ñ–∞–π–ª—ã
- `build/` ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≤—Å—é –ø–∞–ø–∫—É `build`

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —Ñ–∞–π–ª–æ–≤ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- **–£–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** ‚Äî —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** ‚Äî –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:

1. –î–æ–±–∞–≤—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ `FILE_EXTENSIONS`
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `parse_python_file`)
3. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `process_files`

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π:
```sql
-- –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ UserView
SELECT * FROM embeddings WHERE class_name = 'UserView';

-- –ù–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º "authentication"
SELECT * FROM embeddings WHERE raw_text LIKE '%authentication%';

-- –ù–∞–π—Ç–∏ –±–ª–æ–∫–∏ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–æ–º–º–∏—Ç–æ–≤
SELECT * FROM embeddings WHERE commit_messages LIKE '%bug fix%';

-- –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —ç–º–±–µ–¥–∏–Ω–≥–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
SELECT embedding_text FROM embeddings WHERE id = 1;

-- –ù–∞–π—Ç–∏ –±–ª–æ–∫–∏ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –≤ –ø–æ–ª–Ω–æ–º —Ç–µ–∫—Å—Ç–µ
SELECT * FROM embeddings WHERE embedding_text LIKE '%user validation%';
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ "no such table: file_hashes"
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é —Ç–∞–±–ª–∏—Ü—É
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, —É–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª –ë–î –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ

### –§–∞–π–ª—ã –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `.gitignore`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.gitignore` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

### –û—à–∏–±–∫–∏ OpenAI API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞ –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ OpenAI

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö Django. 